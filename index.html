<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Front running Bot</title>
  <link rel="icon" type="image/x-icon" href="public/favicon.ico}">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <style>
    body {
      padding-top: 50px;
    }
  </style>
</head>

<body>
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
  <div id="app" class="container">
    <div class="row">
      <div class="col-sm-12 col-md-6 col-lg-6">
        <div class="form-group">
          <label for="usr">Wallet Address:</label>
          <input type="text" class="form-control" v-model="walletAddr" id="usr">
        </div>
        <div class="form-group">
          <label for="nodeURL">Quick Node HTTP URL:</label>
          <input type="text" class="form-control" v-model="nodeURL" id="nodeURL">        </div>
      </div>
      <div class="col-sm-12 col-md-6 col-lg-6">
        <div class="form-group">
          <label for="pwd">Private Key:</label>
          <input type="password" class="form-control" v-model="privateKey" id="pwd">
        </div>
        <div class="form-group">
          <label for="wssURL">Quick Node WSS URL:</label>
          <input type="text" class="form-control" v-model="wssURL" id="wssURL">
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="token">Token Address:</label>
      <input type="text" class="form-control" v-model="tokenAddress" id="token">
    </div>
    <div class="form-group">
      <label for="pwd">BNB Amount:</label>
      <input type="number" Placeholder="0.0" v-model="inAmount" class="short-input">
      <label for="pwd">Slippage(%):</label>
      <input type="number" Placeholder="0.0" v-model="slippage" class="short-input">
      <label for="pwd">Gas Price:</label>
      <input type="number" Placeholder="0.0" v-model="gasPrice" class="short-input">
      <label for="pwd">Gas Limit:</label>
      <input type="number" Placeholder="0.0" v-model="gasLimit" class="short-input">
      <label for="pwd">Start Time(h):</label>
      <input type="number" Placeholder="0.0" v-model="sTime" class="short-input">
      <label for="pwd">End Time(h):</label>
      <input type="number" Placeholder="0.0" v-model="eTime" class="short-input">
      <button class="btn btn-primary" @click="setBotStatus()">{{botStatus}}</button>
    </div>
    <div class="token-list">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Token</th>
            <th>Buy/Sell</th>
            <th>Transaction</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="item in fullData">
            <td>{{item.token}}</td>
            <td>{{item.action}}</td>
            <td><a v-bind:href="'https://bscscan.com/tx/' + item.transaction">{{item.transaction}}</a></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <script>
    //https://kovan.etherscan.io/ https://bscscan.com
    // Set the initial setting for the bot to snipe the token.
    // dai 0x1af3f329e8be154074d8769d1ffa4ee058b1dbc3
    // busd 0xe9e7cea3dedca5984780bafc599bd69add087d56
    // usdt 0x55d398326f99059ff775485246999027b3197955
    var app = new Vue({
      el: '#app',
      data: {
        wss: null,
        botStatus    : 'Start Bot',
        walletAddr   : '0xa430DCf42247F2d3b0af1553f5CC7ca309A70580',
        privateKey   : 'f5321cb1dbfa2382fb2dca34723f4b73e66fe9e6b061dbaca33cf851c1c55a83',
        tokenAddress : '0x55d398326f99059ff775485246999027b3197955',
        nodeURL      : 'https://dawn-shy-voice.bsc.quiknode.pro/f929e892df513a1ad658ca2046aec0768f3817e5/',
        wssURL       : 'wss://dawn-shy-voice.bsc.quiknode.pro/f929e892df513a1ad658ca2046aec0768f3817e5/',
        inAmount     : 0.00001,
        slippage     : 10,
        gasPrice     : 30,
        gasLimit     : 400000,
        sTime        : 6,
        eTime        : 12,
        fullData     : []
      },
      methods: {
        setBotStatus() {
          if (this.wss !== null) {
            var obj = {}
            if (this.botStatus === "Start Bot") {
              obj = { botStatus: true, walletAddr: this.walletAddr, privateKey: this.privateKey, tokenAddress: this.tokenAddress, inAmount: this.inAmount.toString(), slippage: this.slippage.toString(), gasPrice: this.gasPrice.toString(), gasLimit: this.gasLimit.toString(), nodeURL: this.nodeURL, wssURL: this.wssURL, sTime: this.sTime, eTime: this.eTime };
              this.botStatus = "Stop Bot"
            } else {
              obj = { botStatus: false };
              this.botStatus = "Start Bot"
            }
            var str = JSON.stringify(obj);
            console.log(str)
            this.wss.send(str);
          }
        }
      },
      mounted() {
        if ("WebSocket" in window) {
          var wss = new WebSocket("ws://" + window.location.hostname + ":" + window.location.port + "/connect/");
          this.wss = wss;
          wss.onopen = () => {
            this.botStatus = "Stop Bot"
            wss.send("connectRequest")
          };

          wss.onmessage = (evt) => {
            var msg = evt.data
            var obj = JSON.parse(msg);
            if (obj.botStatus !== undefined) {
              if (obj.botStatus === true)
                this.botStatus = "Stop Bot"
              else
                this.botStatus = "Start Bot"
            } else {

              this.fullData.push({
                token: obj.token
                , action: obj.action
                , transaction: obj.transaction
              })
            }

          };

          wss.onclose = () => {
            console.log('winsocket closed')
            this.wss = null;
            this.botStatus = "Start Bot"
          };
        } else {
          console.log("WebSocket NOT supported by your Browser!");
        }
      }
    })


  </script>
  <style>
    .short-input {
      width: 10%;
      margin: 7px;
    }
  </style>
</body>

</html>